<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="google34949e442e488102"><meta name="baidu-site-verification" content="04tLeUMqMf"><link href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css" rel="stylesheet" type="text/css"><link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon_h_blue.ico?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon_h_blue.ico?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_h_blue.ico?v=5.1.3"><link rel="mask-icon" href="/images/favicon_h_blue.ico?v=5.1.3" color="#222"><meta name="keywords" content="PHP,"><link rel="alternate" href="/atom.xml" title="IceHe" type="application/atom+xml"><meta name="description" content="写 PHP 代码的一些经验与感想。"><meta name="keywords" content="PHP"><meta property="og:type" content="article"><meta property="og:title" content="PHP 编程经验"><meta property="og:url" content="https://icehe.me/php/php/index.html"><meta property="og:site_name" content="IceHe"><meta property="og:description" content="写 PHP 代码的一些经验与感想。"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2018-07-09T16:00:00.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="PHP 编程经验"><meta name="twitter:description" content="写 PHP 代码的一些经验与感想。"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.3",sidebar:{position:"right",display:"always",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!0,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://icehe.me/php/php/"><title>PHP 编程经验 | IceHe</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?ba81ef13fc65c4dcf8cf8586d25818a4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-right page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">IceHe</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">More is in vain when less will serve.</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-quote-left"></i><br>文章</a></li><li class="menu-item menu-item-nav"><a href="/navigation" rel="section"><i class="menu-item-icon fa fa-fw fa-bookmark"></i><br>导航</a></li><li class="menu-item menu-item-cv"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-star"></i><br>简历</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav><style type="text/css">.bold{font-weight:700}.center{text-align:center}.hidden{display:none}.no_underline{border-bottom:0}.white{color:#fff}.pace .pace-progress{background:#000}</style></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://icehe.me/php/php/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="IceHe"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar_pretty_00.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="IceHe"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">PHP 编程经验</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-plus-o"></i> </span><time title="更新于" itemprop="dateCreated datePublished" datetime="2018-07-10T00:00:00+08:00">2018.07</time></span><div class="post-wordcount"><span class="post-meta-divider"></span> <span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span title="字数统计">3,937 </span>字</div><span class="post-category"><span class="post-meta-divider"></span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/PHP/" itemprop="url" rel="index"><span itemprop="name">PHP</span></a> </span></span><span id="/php/php/" class="hidden leancloud_visitors" data-flag-title="PHP 编程经验"><span class="post-meta-divider"></span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="leancloud-visitors-count" title="阅读次数"></span></span><div class="post-description">写 PHP 代码的一些经验与感想。</div></div></header><div class="post-body" itemprop="articleBody"><h2 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h2><p>有太多的编程语言和工具，一旦不常使用，很容易就会遗忘其中一些需要重视的细节。所以，有必要去总结、固化自己掌握的相关知识经验。即使一时忘记了也不要紧，用自己的总结材料来复习，可以快速地「重拾」曾经掌握过的技能。</p><p>笔者水平有限，请谨慎参考本文。可以去 Google，甚至看源码。尽量自己动手写代码，来对具体的情况进行试验，因为文档可能会过时失效，记忆可能会模糊出错，只有用实践来检验真理才是最牢靠的。如发现本文的错误，烦请指正，感谢交流~</p><h3 id="八卦：最好的语言？"><a href="#八卦：最好的语言？" class="headerlink" title="八卦：最好的语言？"></a>八卦：最好的语言？</h3><blockquote class="blockquote-center"><p>PHP 是世界上最好的（编程）语言！</p><p><strong>原始出处不详</strong></p></blockquote><p>不少 PHP 的圈外人和新手不懂行，难免无法理解以至于误解这句流传甚广的话，甚至睥睨 PHP 并施以冷嘲热讽。</p><p>（如果一个程序员对计算机的技术和文化有足够的理解，应该耻于做这种「忽视场景，牵强对比各种编程语言优劣」的事来自找优越感。除非是一些特别的情况，可能他在「钓鱼」或者…… 见下文）</p><p>实际上「PHP 是世界上最好的语言」这句话已经成了一种梗，PHP 程序员经常以这种「自嘲」的方式表明身份。比如，我们也会戏称自己以「拍黄片」（Pai Huang Pian）为业。</p><ul><li>PHP 圈的八卦见闻：<br>竟然有人嘲笑 PHP 的「继父」鸟哥 惠新宸（Laruence <a href="http://weibo.com/laruence" target="_blank" rel="noopener">@weibo</a>、<a href="https://github.com/laruence" target="_blank" rel="noopener">@GitHub</a>、<a href="http://www.laruence.com/" target="_blank" rel="noopener">@Blog</a>）竟然敢自称「亚洲第一程序员」（我真实碰过这么认为的朋友），其实这是一个以讹传讹的失实说法。鸟哥并没有这样自称，「亚一程」这只不过是中国 PHP 小圈子里的友人给他取得的一个绰号而已，是一个富于幽默感的戏称（爱称），也算是由「PHP 是最好的语言」引申出来的梗。毕竟鸟哥给 PHP 社区做出了如此巨大的贡献，旧的 PHP 项目只要换上 PHP7 的运行环境就能有惊人的性能提升（可另行搜索了解详情），然后当年的性能 KPI 就完成了…… 圈内用这样饶有趣味地方式来捧鸟哥，实在是再正常不过的事，哈哈。PHP7 出来已经挺久，现在也不常有人提起「亚一程」这个梗了。</li></ul><h3 id="PHP-的一些槽点"><a href="#PHP-的一些槽点" class="headerlink" title="PHP 的一些槽点"></a>PHP 的一些槽点</h3><p>但是不得不承认，PHP 在诞生之初，由于一些缺乏远见的初始设计，导致了它有着一些难以修正的缺陷，但无伤大雅。在完美主义者的眼里，PHP 确实写起来不够「优雅」。为了兼容性，即使是焕然一新的新版本 PHP7，也无法抛弃全部的历史包袱。这里提其中一些槽点：</p><ol><li><strong>美元符 <code>$</code></strong> 通常放在变量名前面，用于声明和使用变量，有人光是看到 <code>$</code> 美元符就会觉得特不爽。</li><li>内建函数的 <strong>函数名</strong> 风格不一致、或长或短，其中一些函数明显带有 C 语言的风格特征，其实就和 C 语言的库函数同名，然而后来新增的一些内建函数的名字却又比较完整比较长……</li><li>不少函数的 <strong>函数参数</strong> 的排列规律不够一致（可准确预测），如果不常用、又不去参考手册（<a href="http://php.net/" target="_blank" rel="noopener">PHP.net</a>），我会担心自己搞错它们含义、用途和排列顺序。<ul><li>官方网站 <a href="http://php.net/" target="_blank" rel="noopener">PHP.net</a> 也是一个奇特的存在，它是存放参考文档的网页，也像一个论坛或问答区（官网并没有直接提供社区）。参考页面下可以盖楼「评论」，你可以对评论「顶」或「踩」，许多评论会提供相关的使用样例、测试代码和更深入的细节说明，可能比文档正文还管用……</li></ul></li><li><strong>函数的返回值</strong>，跟 C 语言一样，它的返回值并不一致。<ul><li>例如，C 语言的一些关于字符数组的库函数，它们的返回类型是 int，因为 C 不可能依靠抛出异常来表示错误，只能给 int -1 这种值额外赋予特殊的含义，即发生错误，所以表达上并不够清晰和一致（其实这并无大碍，毕竟它是比较接近硬件的机器码，不可能也没必要封装异常这种「高级特性」）。</li><li>PHP 是一种弱类型的语言，虽然也有「类」和「异常」，但是使用一些内建函数也并不抛出异常。例如 <code>strpos()</code>，它会返回字符串中的某种子字符串的出现位置，这个位置由非负的整数来表示，如果找不到就会返回布尔类型的 <code>false</code>。</li><li>这时如果要判断「某个子字符串没在一个字符串里出现」就得用表达式：<br><code>false !== strpos(&#39;字符串&#39;, &#39;子字符串&#39;)</code>。<ul><li>基础说明：<code>!==</code> 是「不全等于」的比较操作符，比较的两个变量的数值及其类型要同时不一样时，表达式的结果才是 <code>true</code>；<code>!=</code> 是「不等于」的比较操作符，只要比较的两个变量的数值相等，表达式结果就是 <code>true</code>，如果它们的数值类型不同，就会对变量进行隐式的类型转换，然后再进行比较。正是因为弱类型语言的这一「隐式类型转换」的过程，许多对编程语言不熟悉、逻辑又不严谨的程序员，写出了 bug 频出的 PHP 代码。</li><li>如果这时误用了逻辑表达式 <code>false != strpos(&#39;字符串&#39;, &#39;子字符串&#39;)</code> 来判断可就麻烦了：<br>子字符串出现在字符串的开头，<code>strpos()</code> 会返回整数 <code>0</code>，<br>然后 <code>0</code> 会转换成 <code>boolean</code> 布尔类型，值为 <code>false</code>，最终表达式同样也会返回 <code>true</code>，然而这是错误的判断结果。它跟 C 语言中的 <code>strpos()</code> 有着「异曲同工之错」，容易被不熟练的人误用。</li></ul></li></ul></li><li><strong>弱类型变量的比较</strong>，详见上一段。「隐式类型转换」是弱类型编程语言的特点，是优点也是缺点 —— 容易上手，但更容易用错。在后文的「逻辑表达式」小节，会有更进一步的细节讨论。</li><li>其它暂略……</li></ol><p><strong>知乎问答<a href="https://www.zhihu.com/question/28596521/answer/49125835" target="_blank" rel="noopener">「PHP既然这么烂，那它是怎么火起来的？」PHP7 核心开发者 惠新宸 Laruence 的回答</a></strong> 值得一看。</p><h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><p><a href="http://php.net/manual/en/language.operators.php" target="_blank" rel="noopener">http://php.net/manual/en/language.operators.php</a></p><p>操作符的优先级<br>老生常谈，我们必须要多加括号 () 以便阅读，一眼看出问题</p><p>PHP7</p><p>PHP-FPM</p><p>Ngnix | Apache</p><p>官方文档 PHP.net</p><p>框架 Yaf Yii Zend Laravel Lumen</p><p>包管理器 composer<br>… install<br>… dump<br>… update<br>过程的 -vvv 详细输出<br>composer.lock<br>composer.json<br>镜像<br>https 下载</p><p>phpunit<br>单元测试</p><p>phpmd &amp; phpcs<br>代码风格检查</p><p>Redis &amp; memcache<br>缓存</p><p>MySQL<br>存储</p><p>PHP - The Right Way<br>清单</p><h3 id="类型判断"><a href="#类型判断" class="headerlink" title="类型判断"></a>类型判断</h3><h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><ul><li><p>本文 <code>$v</code> 代表一般的变量，<code>$vs</code> 代表数组，<code>$vs[$k]</code> 代表通过下标访问数组</p></li><li><p><code>$oo ? $oo : $xx</code> === <code>$oo ?: $xx</code></p><p>注意：<code>$a ?: $b</code> !== <code>$a ?? $b</code></p><p>而且 <code>$a[$k] ?: $b</code> !== <code>$a[$k] ?? $b</code></p></li><li><p><code>empty($v) === !$v</code></p><p>注意：使用下标访问时，即使用 <code>$vs[$k]</code> 时，</p><p><code>empty($vs[$k]) !== !$vs[$k]</code></p><p>所以，<code>empty($a) ? $b : $a</code> === <code>$a ? $a : $b</code> === <code>$a ?: $b</code></p></li><li><p>当 <code>$v</code> 为 <code>0</code>, <code>&#39;&#39;</code>, <code>&#39;0&#39;</code>, <code>[]</code>, <code>null</code>, <code>false</code> 时，</p><p>false === <code>empty($v)</code> === <code>!$v</code></p></li><li><p><code>empty($vs[$k])</code> 已经包含了 <code>isset($vs[$k])</code> 的判断，</p><p>所以，当 <code>$vs[$k]</code> 不存在时，使用 <code>empty($vs[$k])</code> 不会出现数组下标访问的错误</p></li><li><p>当 <code>$params = Request::only(&#39;a&#39;, &#39;b&#39;);</code> 时，</p><p>如果 <code>Request::all()</code> 中不存在 a 参数，<code>$params[&#39;a&#39;] === null</code></p></li></ul><h2 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h2><p>报错全开！<br>报错全关才能正常运行，这样的项目是不合理的。</p><p>isset<br>empty<br>!<br>!!<br>??<br>?:<br>&amp;&amp;<br>||<br>下标访问</p><h2 id="有用的代码封装"><a href="#有用的代码封装" class="headerlink" title="有用的代码封装"></a>有用的代码封装</h2><p>字符串工具 ‘strpos(…) ===(!==) false’ with ‘(!)str_contains(…)’<br>str_contains<br>starts_with<br>ends_with</p><p>数组工具（点操作符访问）<br>array_get<br>array_has<br>array_flat<br>array_pluck</p><p>reset</p><h2 id="编程风格"><a href="#编程风格" class="headerlink" title="编程风格"></a>编程风格</h2><p>类型隐式转换<br>最严重的一个问题，造成各种逻辑错误。</p><p>设计模式<br>单例模式<br>工厂模式<br>反射的问题 __call：IDE 无法做类型推导，除非单步调试，否则无法预知会跳转到哪 -&gt; 结构性开销。<br>过度封装的学习成本</p><p>中间变量<br>方便调试<br>语意清晰<br>虽然为了更简短的代码，我通常不这么做，但是我认为这样是正确的</p><p>函数参数<br>传一个数组，还是传很多参数？</p><p>全局变量<br>过度的蔓延，用一层传一层？<br>值传递，导致中间环节某个不严谨的程序员对修改它的值</p><p>传引用<br>导致不可预知的错误</p><p>逻辑分支<br>if else<br>必加尖括号 {}<br>用 expr &amp;&amp; assign 或 expr || assign 这些费解的方式写条件语句？！<br>不利于单元测试和变量追踪</p><p>全等于和等于，不等于和全不等于<br>== != === !==<br>布尔计算</p><p>控制流<br>尽量少分支<br>优先处理错误（比较短的分支，比较快就返回、退出）<br>使用 ?: 减少 if else<br>函数出口，最好是默认的情况</p><p>过度防卫<br>没有必要，有错就该退出<br>过度的兼容和检查，使代码过于冗余，难以看懂，反而造成更多错误</p><p>单步调试<br>xdebug<br>gdb（这个不懂，但是要提。最好试着使用一下）</p><p>代码同步<br>rsync<br>nc</p><p>运行环境<br>docker<br>service<br>重启 nginx 和 php-fpm<br>nginx 和 php-fpm 的配置文件<br>端口占用<br>php.ini<br>php -i | grep 或 php –hi？<br>第三方组件<br>xdebug<br>安装<br>pecl<br>brew<br>配置</p><p>IDE 的选择</p><p>编程风格<br>PSR<br>数组元素的对齐方式<br>IDE 当然有自动格式化的功能，但是要照顾一般的代码编辑器、Vim、Emacs 等，自动对齐不一定有必要，反而增加了麻烦。<br>过长的代码行<br>一行只做一件事<br>当人可以处理更高复杂性时，真的更容易倾向于写「聪明」的代码。<br>数组最后一个元素后面带 <code>,</code><br>单引号和双引号！<br>用 “o{$x}o” 还是 ‘o’.$x.’o’；还有写不写其中的 {}<br>和 C++ 写法的对比！（静态语言和动态语言对字符串变量的处理）<br>变量命名问题<br>复数 list or -s<br>缩写问题</p><p>PHP7 函参的类型说明<br>一定程度上，帮助了类型检测，不需要你自己进行类型判断 instanceof，更方便发现并抛出错误！</p><p>PHP<br>本身已经能算是一种框架了，针对 Web 开发，已经拥有了相当高层级的封装，和便捷设置<br>_SERVER _GET _POST _GLOBAL 等等全局变量<br>require or include</p><p>最佳实践！<br>入门最好最快的方法<br>毕竟只是工具，没必要自己重新走弯路，在巨人的肩膀上前进。</p><p>PhpStorm 力荐，但贵<br>类型推导，功能内置<br>local history 本地历史<br>重构功能<br>正则替换</p><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><p>看过不少编码规范，还有相关文章和书籍等等。可是看得再多也没有用，知识要内化变成习惯，才算是自己的。所以在这里一次性地快速写出自己的见解，用以检验自己通过日常的工作，到底消化了多少知识，积累了多少经验。</p><p>本文会持续更新，随时补充新的经验和感想，通过不断的记录、总结、反刍，加深理解和记忆，形成好的编程习惯，沉淀出一套适合自己、行之有效的做法。</p><p>因为是快速一次写成的，可能我举的例子有点烂，不过先表达清楚我想要表达的东西就好了。</p><h2 id="清晰的逻辑分支"><a href="#清晰的逻辑分支" class="headerlink" title="清晰的逻辑分支"></a>清晰的逻辑分支</h2><p>王垠的《<a href="http://www.yinwang.org/blog-cn/2015/11/21/programming-philosophy" target="_blank" rel="noopener">编程的智慧</a>》（第一遍写本博文，先不详细分析该文，先提印象最深的启发）让我重新思考这样的一个问题「怎样才算是逻辑清晰的代码？」</p><p>先给示例代码，来说明我想讨论的具体情境。写法一：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(isA, isB)</span>:</span></div><div class="line">    <span class="keyword">if</span> isA:</div><div class="line">        <span class="keyword">return</span> <span class="string">'App'</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> isB:</div><div class="line">        <span class="keyword">return</span> <span class="string">'Boy'</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> false</div></pre></td></tr></table></figure><p>以上代码写成完全的 if … elif … else 的方式应该是写法二：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(isA, isB)</span>:</span></div><div class="line">    <span class="keyword">if</span> isA:</div><div class="line">        <span class="keyword">return</span> <span class="string">'App'</span></div><div class="line">    <span class="keyword">elif</span> isB:</div><div class="line">        <span class="keyword">return</span> <span class="string">'Boy'</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> false</div></pre></td></tr></table></figure><p>大多数人包括我，都会采用第一种讨巧的写法，因为可以少输入一些字符，然而还是可以一下子看懂。当然当函数的代码变长，分支变多，嵌套加深，就没那么好看懂了。</p><p>但毫无疑问，显然第二种方式的逻辑分支之间的关系是最清晰的。对于写惯代码的人来说，第二种写法就显得有点笨了，因为他们基本都能处理更高的复杂度，一眼就能看懂低复杂度的代码。我理性倾向第二种写法，但实际写代码时却往往用第一种。那么问题来了，你觉得该用哪一种写法？</p><p>看一看更复杂的例子，写法一「完全展开的分支」：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(isA, isB)</span>:</span></div><div class="line">    <span class="keyword">if</span> isA:</div><div class="line">        <span class="keyword">if</span> isB:</div><div class="line">            <span class="keyword">if</span> isT:</div><div class="line">                <span class="keyword">return</span> <span class="string">'Tina'</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">return</span> <span class="string">'ABTest'</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="string">'App'</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">if</span> isB:</div><div class="line">            <span class="keyword">if</span> isT:</div><div class="line">                <span class="keyword">return</span> <span class="string">'Tina'</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">return</span> <span class="string">'Boy'</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> false</div></pre></td></tr></table></figure><p>写法二：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(isA, isB, isT)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isA <span class="keyword">and</span> <span class="keyword">not</span> isB: <span class="comment"># 守卫原则的代码写法</span></div><div class="line">        <span class="keyword">return</span> false</div><div class="line"></div><div class="line">    <span class="keyword">if</span> isT <span class="keyword">and</span> <span class="keyword">not</span> isA:</div><div class="line">        <span class="keyword">return</span> <span class="string">'Tina'</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> isA <span class="keyword">and</span> isB:</div><div class="line">        <span class="keyword">return</span> <span class="string">'ABTest'</span></div><div class="line">    <span class="keyword">elif</span> isA:</div><div class="line">        <span class="keyword">return</span> <span class="string">'App'</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'Boy'</span></div></pre></td></tr></table></figure><h2 id="清晰的逻辑"><a href="#清晰的逻辑" class="headerlink" title="清晰的逻辑"></a>清晰的逻辑</h2><h3 id="分支树、逻辑判断"><a href="#分支树、逻辑判断" class="headerlink" title="分支树、逻辑判断"></a>分支树、逻辑判断</h3><p>王垠的 if else 全写策略！</p><p>不要写出过度让人费解的代码。<br>当然当你熟练之后，对一些复杂性有了深入的了解之后，就会下意识写出你能够理解的简短代码。<br>当然还是要避免过度的复杂。</p><h2 id="过度防卫的原则"><a href="#过度防卫的原则" class="headerlink" title="过度防卫的原则"></a>过度防卫的原则</h2><p>（该跑出错误，反映错误，就直接退出报错，不能容忍。有些需要兼容错误才做兼容！）</p><h2 id="守卫原则"><a href="#守卫原则" class="headerlink" title="守卫原则"></a>守卫原则</h2><p>清晰易懂<br>if 后也把 else 写了，控制流程更清晰！（王垠的博文）</p><h2 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h2><p>英语太烂，还懒<br>缩写不统一</p><h2 id="复制粘贴"><a href="#复制粘贴" class="headerlink" title="复制粘贴"></a>复制粘贴</h2><h2 id="中间变量"><a href="#中间变量" class="headerlink" title="中间变量"></a>中间变量</h2><h2 id="包装函数"><a href="#包装函数" class="headerlink" title="包装函数"></a>包装函数</h2><h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><h2 id="IDE"><a href="#IDE" class="headerlink" title="IDE"></a>IDE</h2><h3 id="类型推导"><a href="#类型推导" class="headerlink" title="类型推导"></a>类型推导</h3><h3 id="重构"><a href="#重构" class="headerlink" title="重构"></a>重构</h3><p>减少机械重复的操作</p><h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><h3 id="Live-Template"><a href="#Live-Template" class="headerlink" title="Live Template"></a>Live Template</h3><p>就好像 Emmet 那样。<br>还有 auto complete</p><h2 id="常用函数-1"><a href="#常用函数-1" class="headerlink" title="常用函数"></a>常用函数</h2><h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><h2 id="感受"><a href="#感受" class="headerlink" title="感受"></a>感受</h2><h3 id="堆代码写接口"><a href="#堆代码写接口" class="headerlink" title="堆代码写接口"></a>堆代码写接口</h3><p>「工作无价值」的迷思 —— 不要写得太烂就可以，你随便都可以被新来的人代替。</p><p>大公司打工悖论，不要把自己看得太高，你就是螺丝钉，随时都能被替换掉，这样公司的风险才小，才够稳定。<br>分工也相对提高了效率。</p><h3 id="底层"><a href="#底层" class="headerlink" title="底层"></a>底层</h3><p>高大上的迷思 —— 大公司、复杂业务，就没有干干净的代码。</p><h3 id="没空学"><a href="#没空学" class="headerlink" title="没空学"></a>没空学</h3><p>自己作死而已。学会取舍，人生苦短，找准方向。</p><p>学习是靠自己，靠学校、老师，靠公司、Boss、业务，都是天真的。</p><p>自己不努力没别人能够帮助你。你也要自己努力一把，别人才会去帮助你 —— 问问题之前，请自己先 Google 一下，好好先折腾一番。</p><h3 id="枯燥重复的编码"><a href="#枯燥重复的编码" class="headerlink" title="枯燥重复的编码"></a>枯燥重复的编码</h3><p>做算法题，都比这个有趣。<br>能够忍受重复无趣不是个优点，反而是累赘，让自己更加深陷其中「温水煮青蛙」。</p><p>有危机意识的不甘的人，反而更早跳出陷阱。</p><p>详见，后来在 Test 文件夹写出的好脚本！</p><h3 id="学会很多语言？"><a href="#学会很多语言？" class="headerlink" title="学会很多语言？"></a>学会很多语言？</h3><h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><p>方便做重构</p><h3 id="还有-Macro-宏"><a href="#还有-Macro-宏" class="headerlink" title="还有 Macro 宏"></a>还有 Macro 宏</h3><p>批量化重复的机械性操作。</p><h2 id="Vim-的操作"><a href="#Vim-的操作" class="headerlink" title="Vim 的操作"></a>Vim 的操作</h2><p>少记很多 IDE 或代码编辑器的快捷键。</p><p>null<br>‘’<br>‘true’<br>‘false’<br>‘null’<br>‘-1’<br>‘0’<br>‘1’<br>‘2’<br>false<br>true<br>[]<br>-1<br>0<br>1<br>2</p><p>isset<br>empty<br>is_null<br>is_string<br>is_array<br>!<br>is_numeric<br>is_object<br>is_bool</p></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> IceHe</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://icehe.me/php/php/" title="PHP 编程经验">https://icehe.me/php/php/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/PHP/" rel="tag"># PHP</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/c++/note/" rel="next" title="C++ 笔记"><i class="fa fa-chevron-left"></i> C++ 笔记</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_switch" class="center"><a href="javascript:loadDisqus();">显示评论，需翻墙<br>Show Comments</a></div><script type="text/javascript">function loadDisqus(){$("#disqus_switch").hide(),$("#disqus_thread").show(),run_disqus_script("count.js"),run_disqus_script("embed.js")}</script><div id="disqus_thread" style="display:none"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><a href="/about/"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar_pretty_00.png" alt="IceHe"><p class="site-description motion-element white" itemprop="description"></p></div></a><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> &nbsp;订阅 IceHe</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yourname" target="_blank" title="GitHub">GitHub</a> </span><span class="links-of-author-item"><a href="http://weibo.com/icedes" target="_blank" title="微博">微博</a> </span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/icehe" target="_blank" title="知乎">知乎</a> </span><span class="links-of-author-item"><a href="https://www.douban.com/people/IceHeGZ" target="_blank" title="豆瓣">豆瓣</a></span></div><div class="post-toc" style="max-height:1220px;width:calc(100% + 0px)" id="popular-post-div"><div class="post-toc-content"><ol class="nav hidden" id="popular-list"></ol></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#引子"><span class="nav-text">引子</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#八卦：最好的语言？"><span class="nav-text">八卦：最好的语言？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP-的一些槽点"><span class="nav-text">PHP 的一些槽点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TODO"><span class="nav-text">TODO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#类型判断"><span class="nav-text">类型判断</span></a></li></ol></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#说明"><span class="nav-text">说明</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常用函数"><span class="nav-text">常用函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#有用的代码封装"><span class="nav-text">有用的代码封装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编程风格"><span class="nav-text">编程风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其它"><span class="nav-text">其它</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#清晰的逻辑分支"><span class="nav-text">清晰的逻辑分支</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#清晰的逻辑"><span class="nav-text">清晰的逻辑</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#分支树、逻辑判断"><span class="nav-text">分支树、逻辑判断</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过度防卫的原则"><span class="nav-text">过度防卫的原则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#守卫原则"><span class="nav-text">守卫原则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命名"><span class="nav-text">命名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复制粘贴"><span class="nav-text">复制粘贴</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#中间变量"><span class="nav-text">中间变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#包装函数"><span class="nav-text">包装函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注释"><span class="nav-text">注释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDE"><span class="nav-text">IDE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#类型推导"><span class="nav-text">类型推导</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重构"><span class="nav-text">重构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#搜索"><span class="nav-text">搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Live-Template"><span class="nav-text">Live Template</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用函数-1"><span class="nav-text">常用函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考文档"><span class="nav-text">参考文档</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#感受"><span class="nav-text">感受</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#堆代码写接口"><span class="nav-text">堆代码写接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#底层"><span class="nav-text">底层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#没空学"><span class="nav-text">没空学</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#枯燥重复的编码"><span class="nav-text">枯燥重复的编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#学会很多语言？"><span class="nav-text">学会很多语言？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正则表达式"><span class="nav-text">正则表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#还有-Macro-宏"><span class="nav-text">还有 Macro 宏</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vim-的操作"><span class="nav-text">Vim 的操作</span></a></li></ol></li></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2015 - <span itemprop="copyrightYear">2018</span> <span class="with-love hidden"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">&nbsp;IceHe</span> &nbsp; |&nbsp; &nbsp;<span class="host">Hosted by <a href="https://pages.coding.me">Coding Pages</a></span> &nbsp; |&nbsp;&nbsp; <span class="powered-by"><a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 驱动</span> <span class="post-meta-divider">|</span> <span class="theme-info">主题 <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/velocity/1.5.0/velocity.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/velocity/1.5.0/velocity.ui.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><script type="text/javascript">function run_disqus_script(t){var e=document,i=e.createElement("script");i.src="https://https-icehe-me.disqus.com/"+t,i.setAttribute("data-timestamp",""+ +new Date),"count.js"==t&&(i.id="dsq-count-scr"),(e.head||e.body).appendChild(i)}var disqus_config=function(){this.page.url="https://icehe.me/php/php/",this.page.identifier="php/php/",this.page.title="PHP 编程经验"}</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){var r=!1,s=0,a=0,i=n.title.trim(),c=i.toLowerCase(),l=n.content.trim().replace(/<[^>]+>/g,""),h=l.toLowerCase(),p=decodeURIComponent(n.url),u=[],f=[];if(""!=i&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}u=u.concat(e(t,c,!1)),f=f.concat(e(t,h,!1))}),(u.length>0||f.length>0)&&(r=!0,s=u.length+f.length)),r){[u,f].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});function d(e,o,n,r){for(var s=r[r.length-1],i=s.position,c=s.word,l=[],h=0;i+c.length<=n&&0!=r.length;){c===t&&h++,l.push({position:i,length:c.length});var p=i+c.length;for(r.pop();0!=r.length&&(s=r[r.length-1],i=s.position,c=s.word,p>i);)r.pop()}return a+=h,{hits:l,start:o,end:n,searchTextCount:h}}var g=[];0!=u.length&&g.push(d(0,0,i.length,u));for(var v=[];0!=f.length;){var $=f[f.length-1],C=$.position,m=$.word,x=C-20,w=C+80;x<0&&(x=0),w<C+m.length&&(w=C+m.length),w>l.length&&(w=l.length),v.push(d(0,x,w,f))}v.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var y=parseInt("1");y>=0&&(v=v.slice(0,y));function T(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var b="";0!=g.length?b+="<li><a href='"+p+"' class='search-result-title'>"+T(i,g[0])+"</a>":b+="<li><a href='"+p+"' class='search-result-title'>"+i+"</a>",v.forEach(function(t){b+="<a href='"+p+'\'><p class="search-result">'+T(l,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:a,hitCount:s,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("u1mg4ase5iwhhnyqlavbmd5lkbj7mb5oy4linckob65z1axp","fe7peybzqmpgludkwu43fk15s655i8neejt3pkoezlqtbeu5")</script><script>function pvDesc(e){return(e/=100)>=10?Math.floor(e)/10+" k +":e>=1?Math.floor(e)+"00 +":"< 99"}function setPvAndFadeIn(e){var n=e.get("url"),t=e.get("time");if(t>=PV_SHOW_LIMIT){var o=document.getElementById(n);$(o).find(COUNT_CONTAINER_REF).text(pvDesc(t)),$(o).fadeIn()}}function showPv(e){var n=[],t=$(".leancloud_visitors");t.each(function(){n.push($(this).attr("id").trim())}),new AV.Query(e).containedIn("url",n).find().done(function(e){if(0!==e.length){for(o=0;o<e.length;o++)setPvAndFadeIn(e[o]);for(var o=0;o<n.length;o++){var i=n[o],s=document.getElementById(i),a=$(s).find(COUNT_CONTAINER_REF);""==a.text()&&a.text(0)}}else t.find(COUNT_CONTAINER_REF).text(0)}).fail(function(e,n){console.log("Error: "+n.code+" "+n.message)})}function addCount(e){var n=$(".leancloud_visitors"),t=n.attr("id").trim(),o=n.attr("data-flag-title").trim();new AV.Query(e).equalTo("url",t).find({success:function(n){if(n.length>0){var i=n[0];i.fetchWhenSave(!0),-1!=location.href.indexOf("icehe.me")&&-1==location.href.indexOf("icehe.me/notes/")&&(i.increment("time"),i.save(null,{success:function(e){},error:function(e,n){console.log("Failed to save Visitor num, with error message: "+n.message)}})),setPvAndFadeIn(i)}else{var s=new e,a=new AV.ACL;a.setPublicReadAccess(!0),a.setPublicWriteAccess(!0),s.setACL(a),s.set("title",o),s.set("url",t),s.set("time",1),s.save(null,{success:function(e){var n=$(document.getElementById(t));n.find(".leancloud-visitors-count").text(pvDesc(e.get("time"))),n.fadeIn()},error:function(e,n){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}function ranking(e,n){var t=$("#popular-list2"),o=1==t.length,i=o?20:10;(o||0!=(t=$("#popular-list")).length)&&new AV.Query(e).descending("time").limit(i+10).notContainedIn("url",["/about/","/navigation/","/reward/","/search/","/index/","/resume/","/linux/[06] Linux 通过 pip 安装使用 Shadowsocks - CentOS 7/","/linux/[05] 自动挂载 NTFS 格式的 硬盘分区 - CentOS 7/","/linux/[04] 安装 CentOS 7 后必做的 安全防范措施/","/linux/[03] Update Kernel 升级内核 - CentOS 7/","/linux/[02] Config System Envir 配置系统环境 - CentOS 7/","/linux/[01] 恢复 Windows 的 开机引导 - CentOS 7/","/linux/[00] U盘安装 CentOS 7/"]).limit(i).find().done(function(e){if(0!==e.length){t.append('<li class="nav-item nav-level-1 bold" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #ccc;"> <span class="nav-textwhite"><i class="fa fa-fire"></i> &nbsp; 热榜 </span></li>');for(var n=0;n<e.length;++n){var i=e[n],s=i.get("url"),a=i.get("title"),l=pvDesc(i.get("time"));t.append('<li class="nav-item nav-level-1" '+((n+1)%10==0?'style="border-bottom-width: 1px; border-bottom-style: solid;border-bottom-color: #ccc;"':"")+'> <span class="nav-number"> '+(n+1)%10+'. &nbsp;</span> <a class="nav-link" href="'+s+'"> <span class="nav-text"> '+a+' </span> </a> <span class="nav-number"> <sup> &nbsp;'+l+" </sup> </span> </li>")}o||t.append('<li class="nav-item nav-level-1 bold"> <span class="nav-text"><i class="fa fa-coffee"></i> &nbsp; 欢迎</span></li>'),t.fadeIn()}}).fail(function(e,n){console.log("Error: "+n.code+" "+n.message)})}var PV_SHOW_LIMIT=200,COUNT_CONTAINER_REF=".leancloud-visitors-count";$(function(){var e=AV.Object.extend("Counter");addCount(e),ranking(e)})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/javascript" src="//cdn.bootcss.com/js-cookie/latest/js.cookie.min.js"></script><script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script></body></html>